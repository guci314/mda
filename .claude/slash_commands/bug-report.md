# /bug-report

业务人员报告问题的智能助手，自动分析、定位和修复系统问题。

## 使用方法
```
/bug-report issue="问题描述" [flow="相关流程"] [context="上下文"]
```

## 执行流程

当用户执行此命令时，按以下步骤操作：

### 1. 理解问题
```python
# 分析问题描述
problem_analysis = analyze_issue(issue_description)
# 识别问题类型：业务逻辑/流程/数据/界面
problem_type = identify_problem_type(problem_analysis)
```

### 2. 定位问题根源

根据问题类型采取不同策略：

#### 业务逻辑问题
1. 查找相关PIM模型中的业务规则
2. 分析规则定义是否正确
3. 检查规则执行日志
4. 定位具体的规则或计算错误

#### 流程问题  
1. 加载指定流程的定义
2. 检查流程步骤完整性
3. 验证状态转换逻辑
4. 查找缺失或错误的步骤

#### 数据问题
1. 检查数据模型定义
2. 验证数据约束规则
3. 分析数据一致性
4. 定位验证或存储问题

### 3. 生成修复方案

```markdown
## 修复方案
1. 更新PIM模型中的规则定义
2. 重新生成PSM和代码
3. 运行自动化测试
4. 部署修复版本
```

### 4. 执行修复

自动执行以下步骤：
1. 备份当前PIM模型
2. 应用修复更新
3. 运行转换和生成命令
4. 执行测试验证
5. 部署新版本

### 5. 生成报告

输出修复报告给用户：
```
🔧 问题修复完成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
问题：{issue}
类型：{problem_type}
状态：✅ 已修复

修复内容：
{fix_details}

验证地址：{test_url}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## 示例执行

用户输入：
```
/bug-report issue="创建订单时，VIP客户的折扣没有生效"
```

执行过程：
1. 识别为业务逻辑问题
2. 查找订单服务的PIM模型
3. 定位折扣计算规则
4. 发现规则中客户类型判断有误
5. 修正规则并重新生成代码
6. 运行折扣计算测试
7. 部署修复版本
8. 通知用户验证

## 智能特性

- **自然语言理解**：理解中文问题描述
- **上下文关联**：自动关联相关模型和流程
- **智能修复**：基于问题类型选择最佳修复策略
- **自动验证**：生成针对性的测试用例

## 注意事项

1. 保持问题描述具体和清晰
2. 如果知道相关流程名，请提供
3. 修复完成后及时验证
4. 复杂问题可能需要人工确认