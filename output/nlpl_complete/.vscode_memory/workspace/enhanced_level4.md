# NLPL程序：销售数据分析与报告生成

## 程序目标
对销售数据进行全面的统计分析并生成详细报告，包含完整的错误处理和状态管理机制。

## 程序状态管理
- 初始化状态：程序开始执行
- 数据加载状态：销售数据已加载到内存中
- 分析计算状态：各项统计指标计算完成
- 报告生成状态：分析报告已创建并保存
- 错误状态：记录任何执行过程中出现的错误

## 错误处理策略
- 数据验证：检查数据是否为有效的数值数组
- 计算异常：捕获统计计算过程中可能出现的数学错误
- 文件操作：处理文件读写过程中可能的IO错误
- 模块依赖：检查所需Python模块是否可用

## 主要步骤

### 步骤1: 数据准备与验证
#### 任务描述
加载销售数据并验证数据完整性

#### 输入数据
销售数据数组：[234, 456, 123, 678, 890, 345, 567, 789, 901, 210, 432, 654, 876, 321, 543]

#### 执行逻辑
1. 将销售数据存储到变量中
2. 验证所有数据项都是有效数值
3. 检查数据数组不为空
4. 设置数据加载成功状态

#### 状态更新
- 成功：数据加载状态 → 完成
- 失败：错误状态 → 数据验证错误

#### 错误处理
- 如果数据包含非数值项，记录"数据格式错误"
- 如果数据为空，记录"数据缺失错误"

### 步骤2: 基础统计指标计算
#### 任务描述
计算平均值、中位数和标准差

#### 执行逻辑
1. 使用statistics模块计算平均值
2. 使用numpy或statistics模块计算中位数
3. 使用numpy或statistics模块计算标准差
4. 设置分析计算状态为进行中

#### 状态更新
- 成功：分析计算状态 → 基础统计完成
- 失败：错误状态 → 统计计算错误

#### 错误处理
- 如果模块不可用，记录"模块依赖错误"
- 如果计算过程中出现数学错误，记录"计算异常"

### 步骤3: 最值识别与位置确定
#### 任务描述
找出最大值和最小值及其在数组中的位置

#### 执行逻辑
1. 使用Python内置max()函数找出最大值
2. 使用Python内置min()函数找出最小值
3. 使用index()方法确定最大值和最小值的位置索引
4. 更新分析计算状态

#### 状态更新
- 成功：分析计算状态 → 最值识别完成
- 失败：错误状态 → 最值计算错误

#### 错误处理
- 如果数据为空导致index错误，记录"索引错误"

### 步骤4: 数据计数统计
#### 任务描述
统计大于500的数据元素个数

#### 执行逻辑
1. 遍历数据列表，计数大于500的元素个数
2. 使用列表推导式优化统计过程
3. 更新分析计算状态

#### 状态更新
- 成功：分析计算状态 → 计数统计完成
- 失败：错误状态 → 计数统计错误

#### 错误处理
- 如果遍历过程中出现类型错误，记录"数据类型错误"

### 步骤5: 四分位数计算
#### 任务描述
计算数据的四分位数分布

#### 执行逻辑
1. 计算第一四分位数(Q1)
2. 计算第二四分位数(Q2，即中位数)
3. 计算第三四分位数(Q3)
4. 使用numpy的percentile函数或手动计算
5. 更新分析计算状态

#### 状态更新
- 成功：分析计算状态 → 四分位数计算完成
- 失败：错误状态 → 四分位数计算错误

#### 错误处理
- 如果numpy模块不可用，使用手动计算方法
- 如果计算出现异常，记录"四分位数计算异常"

### 步骤6: 数据分布正态性检验
#### 任务描述
判断数据分布是否符合正态分布

#### 执行逻辑
1. 计算偏度(skewness)来判断分布对称性
2. 计算峰度(kurtosis)来判断分布形态
3. 使用scipy.stats模块进行正态性检验
4. 更新分析计算状态为完成

#### 状态更新
- 成功：分析计算状态 → 正态性检验完成
- 失败：错误状态 → 正态性检验错误

#### 错误处理
- 如果scipy模块不可用，记录"正态性检验模块缺失"
- 如果计算不收敛，记录"正态性检验计算错误"

### 步骤7: 分析报告生成
#### 任务描述
整理所有计算结果并生成详细分析报告

#### 报告结构要求
- 数据概览：描述数据的基本信息，如数据量、数据范围等
- 统计结果：展示所有计算得到的统计指标
- 数据洞察：基于统计结果提供业务洞察和解释
- 可视化建议：提出适合展示这些数据的图表类型和建议

#### 执行逻辑
1. 整理所有计算结果
2. 按照要求的结构组织报告内容
3. 将报告保存为sales_analysis_report.md文件
4. 设置报告生成状态为完成

#### 状态更新
- 成功：报告生成状态 → 完成
- 失败：错误状态 → 报告生成错误

#### 错误处理
- 如果文件写入失败，记录"报告保存错误"
- 如果报告内容组织失败，记录"报告格式错误"

## 输出要求
最终将生成的分析报告保存为 sales_analysis_report.md 文件

## 工具调用计划

### 数据处理和计算
- execute_python: 用于执行统计计算代码，包含异常处理
- execute_python: 用于执行正态性检验代码，包含模块检查

### 文件操作
- write_file: 用于创建最终的分析报告文件，包含IO异常处理
- read_file: 用于读取中间结果文件（如果需要的话）

### 报告生成
- write_file: 用于生成最终的Markdown格式报告，包含格式验证

## 程序结束状态
- 成功状态：所有步骤执行完成，报告已生成
- 错误状态：记录程序执行过程中出现的任何错误及处理方式