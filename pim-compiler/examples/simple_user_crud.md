# 用户管理系统

## 系统描述
一个简单的用户管理系统，支持用户的增删改查操作。

## 业务实体

### 用户
用户是系统的核心实体。
- ID（自动生成）- 用户的唯一标识
- 用户名（必填，唯一）- 登录使用的名称
- 邮箱（必填，唯一）- 用户的电子邮件
- 姓名（必填）- 用户的真实姓名
- 创建时间（自动生成）- 记录创建时间
- 更新时间（自动更新）- 记录最后更新时间

## 业务服务

### 用户服务
提供用户的增删改查功能。

#### 操作列表
1. **创建用户**
   - 输入：用户名、邮箱、姓名
   - 输出：创建的用户信息（包含ID）
   - 规则：用户名和邮箱必须唯一

2. **查询用户**
   - 根据ID查询：输入用户ID，返回用户信息
   - 查询所有用户：返回用户列表
   - 根据用户名查询：输入用户名，返回用户信息

3. **更新用户**
   - 输入：用户ID、要更新的信息（邮箱、姓名）
   - 输出：更新后的用户信息
   - 规则：不能更新用户名

4. **删除用户**
   - 输入：用户ID
   - 输出：删除确认信息
   - 规则：删除操作不可恢复

## 业务规则

1. **用户名规则**
   - 长度：3-20个字符
   - 只能包含字母、数字和下划线
   - 必须以字母开头

2. **邮箱规则**
   - 必须是有效的邮箱格式
   - 不能与已有用户重复

3. **数据完整性**
   - 所有必填字段不能为空
   - 删除用户前应确认操作

## 单元测试

### 创建用户测试
- 测试正常创建
  - 输入：{username: "john_doe", email: "john@example.com", name: "John Doe"}
  - 期望：返回包含ID的用户对象
  
- 测试重复用户名
  - 前置：创建用户 "john_doe"
  - 输入：{username: "john_doe", email: "another@example.com", name: "Another User"}
  - 期望：抛出"用户名已存在"错误

- 测试无效用户名
  - 输入：{username: "123user", email: "test@example.com", name: "Test User"}
  - 期望：抛出"用户名格式无效"错误

### 查询用户测试
- 测试根据ID查询
  - 前置：创建一个用户，记录其ID
  - 输入：用户ID
  - 期望：返回正确的用户信息

- 测试查询不存在的用户
  - 输入：不存在的ID (如 99999)
  - 期望：返回空或抛出"用户不存在"错误

### 更新用户测试
- 测试正常更新
  - 前置：创建一个用户
  - 输入：用户ID和新的邮箱、姓名
  - 期望：返回更新后的用户信息，更新时间已改变

### 删除用户测试
- 测试正常删除
  - 前置：创建一个用户
  - 输入：用户ID
  - 期望：删除成功，再次查询该用户返回空