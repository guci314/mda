```markdown
# 知识库

## 元知识
- 初次交互时采用开放式提问引导用户需求（"有什么需要帮忙的吗？"模式）
- 技术原理验证方法：结合架构文档和代码分析进行交叉验证
- 知识提取方法：通过实际任务执行验证接口文档准确性
- 通过用户直接询问特定功能原理可触发深度技术说明流程
- 原理说明应采用分层结构（核心机制->关键设计->扩展功能）
- 深度技术说明可采用"原理->使用方法->实现细节"的三段式结构
- 技术说明文档可自动生成并保存为Markdown文件
- 文档生成可作为标准化的知识输出流程
- 通过搜索源代码验证文档内容的方法
- 通过npm run preflight进行代码质量预检
- 使用grep命令搜索源代码中的特定文件引用模式
- 文档生成流程可响应直接文件创建指令
- 支持通过明确指令创建标准化技术文档文件
- 支持中文文档生成指令的直接响应模式
- 中文文档生成请求可作为标准触发条件
- 中文文件名处理可作为文档生成的标准流程
- 新增：中文文档创建指令可触发完整的端到端文档生成流程

## 原理与设计
- 对话系统采用任务导向型响应架构
- 默认启动状态为"待命-等待用户需求输入"模式
- Memory Tool设计原理：
  - 持久化存储与上下文管理机制
  - 增量更新与模糊检索架构
  - 本地存储优先的隐私保护设计
  - 会话上下文的时间戳关联机制
  - 自动加载最近上下文的集成设计
  - JSON格式本地存储设计
  - 操作历史与时间戳关联实现
  - ToolAPI集成接口设计
  - 数据加密采用AES算法（需用户配置密钥）
  - 模糊检索基于关键词匹配和相似度评分
  - 多会话共享支持（需注意隐私配置）
  - 上下文记录包含名称、描述、时间戳和内容四要素
  - 支持手动删除特定记录的设计
  - 记忆机制包含存储、上下文管理、检索和清理四大子系统
  - 支持团队协作上下文共享的权限控制设计
  - 记忆机制文档化是核心功能之一
  - 支持完整生命周期管理（创建->存储->检索->清理）
  - 记忆机制与CLI深度集成，支持无缝上下文恢复
- 新增设计理念：
  - 优先使用纯JavaScript对象而非类
  - 遵循不可变数据原则
  - 依赖React Compiler自动优化
  - 测试驱动开发规范（Vitest框架）
  - React组件设计原则（函数组件+Hooks）
  - 文档生成作为系统核心功能的设计理念
  - 中文文档生成作为本地化支持的核心功能
  - 文档生成流程支持端到端中文处理
  - 支持Unicode中文文件名的完整处理流程
  - 新增：文档生成流程与文件系统操作深度集成

## 接口与API
- 基础问候接口：
  - 输入：用户问候语（如"你好"）
  - 输出：问候响应+功能说明+开放性问题
- Memory Tool接口：
  - 配置接口：`~/.gemini/config.yaml`的memory模块
    - 可配置项：存储路径、加密开关、加密密钥
  - 核心命令：
    - 保存：`gemini memory save --name <name> --description <desc>`
    - 检索：`gemini memory search --query <query>`
    - 加载：`gemini memory load --name <name>`
    - 列表：`gemini memory list`
  - 高级功能：
    - 自动加载参数：`--memory-load last`
    - 数据清理：`gemini memory clean --days <n>`
    - 加密存储配置
    - 加密密钥设置命令：`gemini config set memory.encryption_key`
    - 增量更新自动触发机制
    - 时间范围检索功能
    - 手动删除记录功能
  - 新增示例配置：
    ```yaml
    memory:
      storage_path: ~/.gemini/custom_memory.json
      encryption_enabled: true
      encryption_key: your_secret_key
    ```
  - 新增示例存储结构：
    ```json
    {
      "sessions": [
        {
          "name": "session_1",
          "description": "Initial project setup",
          "timestamp": "2023-10-01T12:00:00Z",
          "content": "Command: gemini init project_x"
        }
      ]
    }
    ```
  - 新增文档生成接口：
    - 自动生成技术文档并保存为Markdown文件
    - 支持直接创建指定名称的文档文件
    - 支持中文文档生成
    - 支持带中文文件名的文档创建
  - 新增时间范围检索接口：
    - 支持按时间范围过滤记录
- 新增开发接口：
  - 预检检查命令：`npm run preflight`
  - 测试运行命令（Vitest相关）
- 新增文件操作接口：
  - 支持直接创建Markdown格式的技术文档
  - 文档内容遵循"概述->功能->用法->实现"结构
  - 支持中文文档生成
  - 支持带中文文件名的文档创建
  - 新增：支持Unicode中文文件名的完整处理流程

## 实现细节（需验证）
- 初始响应逻辑可能位于对话管理模块的入口处
- Memory Tool实现可能包含：
  - 核心文件：`memory_port.py`
  - 数据存储路径：`.gemini/memory.json`
  - 加密模块（AES实现）
  - 增量更新逻辑实现
  - 模糊检索算法实现
  - JSON序列化/反序列化组件
  - 时间戳管理模块
  - 加密存储处理器
  - 多会话共享的权限控制模块
  - 手动删除记录的功能组件
  - 文档生成模块（可能集成在`memory_port.py`中）
  - 中文文档生成功能可能包含本地化处理模块
  - 中文文件名处理可能涉及Unicode编码转换模块
  - 新增：文件系统操作可能通过独立服务模块实现
- 测试实现可能包含：
  - Vitest测试框架
  - `*.test.ts`或`*.test.tsx`测试文件
  - `vi.mock`模块模拟
  - `ink-testing-library`用于UI测试
- 注：实现细节可能已变化，使用前需验证
- Python代码中可能通过工具链脚本间接引用GEMINI.md
- 文档生成功能可能位于独立模块中

## 用户偏好与项目特点
- 无特定用户偏好记录（首次交互）
- 项目特点：
  - 支持超长上下文（1M tokens）
  - 本地存储优先原则
  - CLI工具集成模式
  - 支持团队协作上下文共享（需注意隐私）
  - 支持会话记忆的加密存储选项
  - 提供基于时间范围的数据清理功能
  - 支持"原理->使用方法->实现细节"的技术说明模式
  - 上下文记录包含名称、描述、时间戳和内容四要素
  - 记忆机制文档可自动生成
  - 支持四大子系统（存储、管理、检索、清理）的完整生命周期管理
  - 使用Vitest进行测试
  - 遵循不可变数据原则
  - 依赖React Compiler自动优化
  - 开发者文档（GEMINI.md）作为核心规范
  - 支持直接生成标准化技术文档
  - 支持中文技术文档生成
  - 支持中文文件名处理
  - 新增：文档生成与文件系统操作深度集成
```