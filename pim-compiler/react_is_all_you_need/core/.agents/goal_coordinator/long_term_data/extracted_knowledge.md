# 知识库

## 元知识
- **测试驱动开发循环**：运行pytest→获取失败数量→修复→再运行→直到0失败
- **语法错误定位**：pytest收集失败时，优先检查最近修改的测试文件
- **快速验证**：每次代码修改后立即运行pytest，避免累积错误
- **错误模式识别**：测试文件中的缩进错误、括号不匹配、引号未闭合是常见语法问题

## 原理与设计
- **四层记忆架构**：元知识（学习方法）>原理（设计理念）>接口（API）>实现（代码）
- **目标驱动执行**：明确当前状态→目标状态→差距→行动→验证的循环
- **渐进式修复**：从语法错误→逻辑错误→功能缺陷的修复顺序

## 接口与API
- **pytest命令**：`pytest -v` 显示详细输出，`pytest tests/test_xxx.py` 运行特定测试
- **测试文件结构**：`tests/`目录下按功能模块组织测试文件
- **AsyncClient用法**：用于FastAPI异步测试的HTTP客户端
- **pytest标记**：`@pytest.mark.asyncio` 标记异步测试，`@pytest.fixture` 创建测试夹具

## 实现细节（需验证）
- **测试文件位置**：`tests/test_reservations.py` 包含预约API测试
- **项目结构**：
  - `app/` - 主应用代码
  - `tests/` - 测试文件
  - `models/` - 数据模型
  - `routers/` - API路由
  - `services/` - 业务逻辑
- **数据库文件**：`library.db` SQLite数据库文件
- **配置文件**：`pytest.ini` 包含pytest配置

## 用户偏好与项目特点
- **零容忍测试失败**：必须修复所有测试失败才能完成任务
- **具体数字报告**：使用"1 failed"而非"有些失败"的精确描述
- **持续验证**：每次修改后必须运行pytest验证效果