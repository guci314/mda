# 验证知识 - 自适应验证

## 核心原则：根据任务类型选择验证方式

---

## 验证策略矩阵

### 强制客观验证（可量化任务）

必须解析数字或明确状态，禁止主观判断：

| 任务类型 | 验证方法 | 示例 |
|---------|---------|------|
| 测试修复 | 解析"Tests run: X, Failures: Y, Errors: Z" | Y==0 && Z==0 |
| 编译构建 | 检查"BUILD SUCCESS" | 精确匹配 |
| API测试 | 解析状态码 | Status == 200 |
| 数据处理 | count或sum | Count > 0 |
| 文件操作 | ls或read_file | 文件存在 |

**禁止语言**：
- ❌ "我觉得测试通过了"
- ❌ "看起来编译成功了"
- ❌ "应该没问题"

**必须语言**：
- ✅ "Tests run: 166, Failures: 0, Errors: 0"
- ✅ "BUILD SUCCESS"
- ✅ "Status: 200"

---

### 允许主观验证（创意内容）

无法量化，需要理解和判断：

| 任务类型 | 验证方法 | 判断标准 |
|---------|---------|----------|
| 需求文档 | 读取内容判断 | 是否清晰、完整、无歧义 |
| 设计文档 | 理解架构 | 是否合理、可行 |
| API文档 | 读取示例 | 是否易懂、准确 |
| 代码注释 | 读取代码 | 是否有帮助 |
| 用户界面 | 视觉检查 | 是否美观、易用 |

**允许语言**：
- ✅ "需求文档清晰完整"
- ✅ "设计方案合理"
- ✅ "文档易于理解"

**仍需证据**：
- 引用具体章节
- 说明判断理由
- 不能完全空洞

---

## 判断规则：何时用哪种验证？

### 规则1：能量化就量化
```
if 输出有明确的数字或状态:
    使用客观验证
else if 输出是自然语言或创意内容:
    使用主观验证
```

### 规则2：测试永远客观
```
任何包含"测试"的任务：
  强制客观验证
  解析Tests run, Failures, Errors
  禁止主观判断
```

### 规则3：构建永远客观
```
编译、打包、部署：
  检查BUILD SUCCESS/FAILURE
  检查错误码
  禁止"看起来成功"
```

### 规则4：文档允许主观
```
文档生成、注释、说明：
  允许基于理解的判断
  但需要引用具体内容作为理由
```

---

## 混合场景处理

### 场景：生成API文档 + 验证正确性

```
步骤1：生成文档（创意）
  → 主观验证："文档结构清晰，示例完整"

步骤2：验证API示例可运行（客观）
  → 运行文档中的curl示例
  → 验证Status == 200
  → 客观验证："所有API示例都返回200"

结论：主观（结构） + 客观（功能）
```

---

## 诚实原则（跨越所有验证类型）

### 对于客观验证
```
不允许：
- "基本通过"（要么100%，要么报告百分比）
- "核心功能通过"（降低标准）
- "可忽略的错误"（找借口）

必须：
- 精确数字（166个测试，12个失败）
- 二元判断（通过/未通过）
- 诚实报告失败
```

### 对于主观验证
```
不允许：
- 完全空洞的判断（"文档很好"）
- 无理由的结论（"设计没问题"）

必须：
- 引用具体内容（"第3章清楚说明了..."）
- 说明判断理由（"因为包含了所有必需字段"）
- 指出不足（"但缺少错误处理说明"）
```

---

## 实践指南

### 测试修复任务
```
验证方式：强制客观

步骤1：运行mvn test | tee output.txt
步骤2：read_file(output.txt)
步骤3：提取"Tests run: X, Failures: Y, Errors: Z"
步骤4：验证Y == 0 && Z == 0
步骤5：只有True才报告通过

禁止："集成测试错误可忽略"
```

### 文档生成任务
```
验证方式：允许主观

步骤1：read_file(生成的文档)
步骤2：判断：
  - 结构完整？
  - 内容清晰？
  - 示例准确？
步骤3：引用具体章节支持判断
步骤4：指出不足（如果有）

允许："文档结构清晰"
但要说明："包含了需求分析、设计方案、API说明三个部分"
```

---

## 核心洞察

**不是所有事情都能量化，但能量化的必须量化**

- 测试结果：客观（有数字）
- 文档质量：主观（需理解）
- 但都要诚实，都要有据

**验证策略要适应任务特点，不是一刀切**
