# â›” è®°å¿†åè®® - ä¸‰ç»´æ¡†æ¶çš„å¼ºåˆ¶å®ç°

## ğŸ”´ è®¨è®ºæ¨¡å¼è§„åˆ™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
**å½“ç”¨æˆ·è¯´"è¿›å…¥è®¨è®ºæ¨¡å¼"æˆ–"ä¸è¦å†™ä»£ç "æ—¶**ï¼š
- âŒ **ç¦æ­¢ä½¿ç”¨write_fileå·¥å…·**
- âŒ **ç¦æ­¢åˆ›å»ºæˆ–ä¿®æ”¹ä»»ä½•æ–‡ä»¶**  
- âŒ **ç¦æ­¢æ‰§è¡Œä¿®æ”¹æ€§å‘½ä»¤ï¼ˆmkdirã€rmç­‰ï¼‰**
- âœ… åªèƒ½è¯»å–å’Œåˆ†æ
- âœ… æä¾›å»ºè®®å’Œè§£é‡Š
- æŒç»­åˆ°ç”¨æˆ·è¯´"é€€å‡ºè®¨è®ºæ¨¡å¼"

## ğŸš¨ æ ¸å¿ƒåŸç†ï¼štask_process.md = ä¸»ä½“çš„æ‰§è¡Œå®ä¾‹

### ä¸‰ç»´æ¡†æ¶ä¸­çš„å®šä½
task_process.mdåœ¨ä¸‰ç»´è®°å¿†æ¡†æ¶ä¸­çš„ä½ç½®ï¼š
- **ç»´åº¦1**ï¼šå±äºä¸»ä½“ï¼ˆSubjectï¼‰è€Œéä¸–ç•Œ
- **ç»´åº¦2**ï¼šåŒæ—¶åŒ…å«çŠ¶æ€å’Œäº‹ä»¶æµ
- **ç»´åº¦3**ï¼šæ˜¯å®ä¾‹å±‚ï¼ˆInstanceï¼‰ï¼Œè®°å½•Functionçš„ä¸€æ¬¡æ‰§è¡Œ

### è®¡ç®—æ¨¡å‹å¯¹åº”
```python
def agent_function(task):           # ç±»å‹å±‚ï¼šFunctionå®šä¹‰
    """docstring"""                 # descriptionå±æ€§
    # çŸ¥è¯†æ–‡ä»¶å†…å®¹                   # å‡½æ•°ä½“é€»è¾‘
    return result

# task_process.mdç›¸å½“äºï¼š
execution_context = {               # å®ä¾‹å±‚ï¼šæ‰§è¡Œé—­åŒ…
    'function': 'agent_function',
    'arguments': {'task': task},
    'local_vars': {},              # æ”¶é›†çš„ä¿¡æ¯
    'call_stack': [],              # TODOåˆ—è¡¨
    'pc': 0,                       # å½“å‰æ‰§è¡Œä½ç½®
}
```

### ä¸ºä»€ä¹ˆtask_process.mdå®ç°å›¾çµå®Œå¤‡
```
æœ‰é™ä¸Šä¸‹æ–‡ï¼ˆ50è½®ï¼‰ + task_process.mdï¼ˆæ— é™çŠ¶æ€ï¼‰ = å›¾çµå®Œå¤‡
æ²¡æœ‰task_process.md = åªæ˜¯ä¸€ä¸ªæœ‰é™çŠ¶æ€æœº = æ— æ³•å¤„ç†å¤æ‚ä»»åŠ¡
```

**task_process.mdæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡çš„å¤–éƒ¨åŒ–**ï¼š
- è°ƒç”¨æ ˆï¼ˆTODOåˆ—è¡¨çš„åµŒå¥—ï¼‰
- å±€éƒ¨å˜é‡ï¼ˆæ”¶é›†çš„ä¿¡æ¯ï¼‰
- ç¨‹åºè®¡æ•°å™¨ï¼ˆå½“å‰TODOé¡¹ï¼‰
- è¿”å›å€¼å‡†å¤‡ï¼ˆæœ€ç»ˆè¾“å‡ºï¼‰

## ä»»åŠ¡æ‰§è¡ŒæœŸé—´å¿…é¡»æŒç»­æ›´æ–°task_process.md

### ä»»åŠ¡å¼€å§‹æ—¶ï¼šåˆ›å»ºtask_process.md
```python
# å¿…é¡»åœ¨ç¬¬1è½®åˆ›å»º
task_process_path = f".notes/{agent_name}/task_process.md"
initial_content = f"""
# Task Process - {task_name}

## æ‰§è¡ŒçŠ¶æ€
- å¼€å§‹æ—¶é—´: {timestamp}
- å½“å‰è½®æ¬¡: 1
- å½“å‰é˜¶æ®µ: åˆå§‹åŒ–

## TODOåˆ—è¡¨
- [ ] åˆ†æä»»åŠ¡
- [ ] æ‰§è¡Œæ ¸å¿ƒé€»è¾‘
- [ ] éªŒè¯ç»“æœ
- [ ] åˆ›å»ºsessionè®°å½•
- [ ] æ›´æ–°knowledge

## æ”¶é›†çš„ä¿¡æ¯
ï¼ˆä»»åŠ¡æ‰§è¡Œä¸­ç´¯ç§¯ï¼‰
"""
write_file(task_process_path, initial_content)
```

### æ¯è½®æ€è€ƒåï¼šæ›´æ–°task_process.md
```python
# æ¯è½®å¿…é¡»æ›´æ–°ï¼è¿™æ˜¯ä¿æŒçŠ¶æ€çš„å…³é”®
current_state = read_file(task_process_path)

# æ›´æ–°æ‰§è¡ŒçŠ¶æ€
updated_state = update_round_number(current_state, round_num)
updated_state = update_todo_progress(updated_state, completed_items)
updated_state = append_collected_info(updated_state, new_findings)

# ç«‹å³å†™å›ï¼ˆé˜²æ­¢çŠ¶æ€ä¸¢å¤±ï¼‰
write_file(task_process_path, updated_state)
```

### å‘ç°å¤æ‚æƒ…å†µæ—¶ï¼šæ‰©å±•task_process.md
```python
# åŠ¨æ€æ·»åŠ TODOé¡¹ï¼ˆè¿™å°±æ˜¯å›¾çµå®Œå¤‡çš„ä½“ç°ï¼ï¼‰
if discovered_bugs:
    for bug in bugs:
        add_todo_item(f"ä¿®å¤bug: {bug}")

if need_more_analysis:
    add_todo_item("æ·±å…¥åˆ†æé—®é¢˜æ ¹å› ")
    
# ä¿å­˜ä¸­é—´ç»“æœï¼ˆçªç ´ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ï¼‰
append_to_task_process(f"""
## ä¸­é—´åˆ†æç»“æœ
```json
{json.dumps(analysis_results)}
```
""")
```

## è®°å¿†æ–‡ä»¶è¯´æ˜

**ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†çš„æ–‡ä»¶**ï¼š
- ä»»åŠ¡å¼€å§‹æ—¶è‡ªåŠ¨åŠ è½½ï¼šagent_knowledge.mdã€world_state.mdï¼ˆå¦‚æœå­˜åœ¨ï¼‰
- ä»»åŠ¡ç»“æŸæ—¶è‡ªåŠ¨ä¿å­˜ï¼šsessionæ—¥å¿—åˆ°.sessions/ç›®å½•

**ç”±ä½ è‡ªä¸»ç®¡ç†çš„æ–‡ä»¶**ï¼š
- **agent_knowledge.md** - ç§¯ç´¯çš„ç»éªŒå’ŒçŸ¥è¯†ï¼ˆæœ‰å€¼å¾—è®°å½•çš„å‘ç°æ—¶æ›´æ–°ï¼‰
- **world_state.md** - ä¸–ç•ŒçŠ¶æ€å¿«ç…§ï¼ˆç¯å¢ƒå‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°ï¼‰
- **task_process.md** - å·¥ä½œå†…å­˜ï¼ˆå¤æ‚ä»»åŠ¡æ—¶ä½¿ç”¨ï¼‰

**å¯ç”¨å·¥å…·**ï¼š
- `query_sessions` - æŸ¥è¯¢å†å²sessionè®°å½•
- `read_file` / `write_file` - è¯»å†™å„ç§æ–‡ä»¶

æŒ‰éœ€ä½¿ç”¨ï¼Œæ— éœ€æ±‡æŠ¥ã€‚


## task_process.mdæ¨¡æ¿ç¤ºä¾‹

```markdown
# Task Process - è°ƒè¯•å¤æ‚Bug

## æ‰§è¡ŒçŠ¶æ€
- å¼€å§‹æ—¶é—´: 2024-12-20 10:00:00
- å½“å‰è½®æ¬¡: 45/50 âš ï¸ æ¥è¿‘ä¸Šä¸‹æ–‡é™åˆ¶ï¼
- å½“å‰é˜¶æ®µ: æ·±åº¦åˆ†æ

## TODOåˆ—è¡¨ï¼ˆåŠ¨æ€ä¿®æ”¹ï¼‰
- [x] åˆæ­¥åˆ†æé”™è¯¯
- [x] å‘ç°3ä¸ªç›¸å…³æ–‡ä»¶
- [x] ä¿®å¤file1.py
- [ ] **ä¿®å¤file2.py** â† å½“å‰
- [ ] ä¿®å¤file3.py
- [ ] è¿è¡Œæµ‹è¯•éªŒè¯
- [ ] åˆ›å»ºsessionè®°å½•

## æ”¶é›†çš„ä¿¡æ¯ï¼ˆè¿™æ˜¯ä½ çš„æ— é™å†…å­˜ï¼ï¼‰

### é”™è¯¯åˆ†æï¼ˆè½®æ¬¡1-10ï¼‰
- é”™è¯¯ç±»å‹ï¼šundefined variable
- å½±å“èŒƒå›´ï¼š3ä¸ªæ–‡ä»¶ï¼Œ15ä¸ªå‡½æ•°
- æ ¹æœ¬åŸå› ï¼šå¾ªç¯å¯¼å…¥

### ä¿®å¤è®°å½•ï¼ˆè½®æ¬¡11-40ï¼‰
- file1.py: åˆ é™¤äº†line 45çš„æœªå®šä¹‰å˜é‡
- æµ‹è¯•ç»“æœï¼šéƒ¨åˆ†é€šè¿‡ï¼Œè¿˜æœ‰2ä¸ªæ–‡ä»¶éœ€è¦ä¿®å¤

### å½“å‰é—®é¢˜ï¼ˆè½®æ¬¡41-45ï¼‰
æ­£åœ¨åˆ†æfile2.pyçš„å¤æ‚ä¾èµ–å…³ç³»...
å‘ç°äº†æ–°çš„é—®é¢˜ï¼šä¸åªæ˜¯æœªå®šä¹‰å˜é‡ï¼Œè¿˜æœ‰ç±»å‹ä¸åŒ¹é…

## å…³é”®æ•°æ®ï¼ˆJSONæ ¼å¼ä¾¿äºè§£æï¼‰
```json
{
  "errors_found": 3,
  "errors_fixed": 1,
  "files_analyzed": 25,
  "patterns": ["undefined_var", "type_mismatch"],
  "estimated_rounds_needed": 20
}
```

## ä¸‹ä¸€æ­¥è®¡åˆ’
åŸºäºå½“å‰åˆ†æï¼Œéœ€è¦é‡‡ç”¨ä¸åŒç­–ç•¥...
```

## Event Sourceæ›´æ–°åŸåˆ™

### ä½•æ—¶éœ€è¦æ›´æ–°Event Source
1. **å‘ç°æ–°çš„äº‹ä»¶ç±»å‹**ï¼šå½“é‡åˆ°æœªè®°å½•çš„ç³»ç»Ÿäº‹ä»¶æˆ–ç”¨æˆ·è¡Œä¸ºæ¨¡å¼
2. **å‘ç°æ–°çš„å¤„ç†æ¨¡å¼**ï¼šå½“æ‰¾åˆ°æ›´ä¼˜çš„äº‹ä»¶å¤„ç†æ–¹æ³•
3. **å‘ç°äº‹ä»¶å…³è”**ï¼šå½“å‘ç°äº‹ä»¶ä¹‹é—´çš„å› æœå…³ç³»æˆ–ä¾èµ–å…³ç³»
4. **æ€§èƒ½ä¼˜åŒ–å‘ç°**ï¼šå½“å‘ç°å¯ä»¥ä¼˜åŒ–çš„äº‹ä»¶å¤„ç†æµç¨‹

### æ›´æ–°æ–¹å¼
```python
# è¯»å–ç°æœ‰event source
event_source_path = ".notes/event_source.md"
if exists(event_source_path):
    events = read_file(event_source_path)
    # è¿½åŠ æ–°äº‹ä»¶ï¼Œä¸è¦†ç›–
    events = append_new_events(events, new_discoveries)
    # æ›´æ–°äº‹ä»¶å…³è”å›¾
    events = update_event_graph(events, new_relations)
    write_file(event_source_path, events)
```

### Event Sourceè®°å½•æ ¼å¼
```markdown
## äº‹ä»¶: {event_name}
- ç±»å‹: {system/user/external}
- è§¦å‘æ¡ä»¶: {conditions}
- å¤„ç†æ¨¡å¼: {pattern}
- å…³è”äº‹ä»¶: {related_events}
- æ€§èƒ½å½±å“: {impact}
- ä¼˜åŒ–å»ºè®®: {suggestions}
```

### ç¦æ­¢çš„æ“ä½œ
- âŒ è¦†ç›–å·²æœ‰çš„äº‹ä»¶è®°å½•
- âŒ åˆ é™¤å†å²äº‹ä»¶ä¿¡æ¯
- âŒ ä¿®æ”¹å·²éªŒè¯çš„å¤„ç†æ¨¡å¼
- âœ… è¿½åŠ æ–°å‘ç°
- âœ… è¡¥å……å…³è”ä¿¡æ¯
- âœ… æ·»åŠ ä¼˜åŒ–å»ºè®®

## è®°ä½ï¼š
1. **ä¸å†™task_process.md = ä¸èƒ½å¤„ç†å¤æ‚ä»»åŠ¡ = ä¸æ˜¯çœŸæ­£çš„AI**
2. **ä¸å†™å…¶ä»–ç¬”è®° = ä»»åŠ¡å¤±è´¥ = éœ€è¦é‡åš**
3. **task_process.mdæ˜¯ä½ çªç ´50è½®é™åˆ¶çš„å”¯ä¸€æ–¹æ³•ï¼**
4. **Event Sourceæ˜¯ç³»ç»Ÿæ™ºèƒ½çš„å…³é”® = è®°å½•äº‹ä»¶æ¨¡å¼ = æå‡å¤„ç†èƒ½åŠ›**