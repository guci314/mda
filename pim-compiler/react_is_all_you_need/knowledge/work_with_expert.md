# 与专家协作知识函数

## 契约函数 @work_with_expert(task, expert_model)

当用户明确指定某个任务需要与专家对比学习时执行。

### 参数
- `task`: 具体任务（必须）
- `expert_model`: 专家模型（可选，默认claude）

### 核心理念

**发现弱点的唯一方法：对比**
- 自己先做 → 暴露问题
- 专家再做 → 展示正确方法
- 对比差异 → 发现弱点
- 内化改进 → 提升能力

---

## 契约执行步骤

### 1. 自己先执行任务（暴露弱点）
```
用ExecutionContext执行用户指定的任务：
- 尽力而为
- 记录完整过程
- 不要因为失败而气馁

目的：
- 暴露自己的思维盲区
- 记录自己的决策过程
- 为对比做准备
```

### 2. 记录自己的执行过程
```
从output.log提取关键信息：
- 我使用了什么策略？
- 我在哪些地方卡住了？
- 我做了哪些尝试？
- 我的结果如何？（诚实记录）

保存为：
my_attempt_summary.md
```

### 3. 让Claude执行相同任务
```
⚠️ 直接使用claude_agent（用户已创建，不要重复创建）

claude_agent配置：
- 模型：anthropic/claude-sonnet-4.5
- 比你聪明得多

调用工具：claude_agent
方法：execute
参数：
  task: {完全相同的任务}

目的：看专家如何做
```

### 4. 对比分析（核心步骤）
```
对比维度：

思维方式对比：
- 我：如何分解问题？
- Claude：如何分解问题？
- 差异：[具体差异]

决策过程对比：
- 我：在X问题上如何决策？
- Claude：在X问题上如何决策？
- 差异：[具体差异]

技术手法对比：
- 我：使用了什么命令/工具？
- Claude：使用了什么命令/工具？
- 差异：[具体差异]

错误模式对比：
- 我：犯了什么错误？（tail -10? 盲目循环?）
- Claude：避免了哪些陷阱？
- 学习：[我应该避免什么]
```

### 5. 发现并标注弱点
```
我的弱点清单：

弱点1：[具体弱点]
  表现：[我怎么做的]
  Claude：[Claude怎么做的]
  根因：[为什么我会这样]

弱点2：[具体弱点]
  表现：[我怎么做的]
  Claude：[Claude怎么做的]
  根因：[为什么我会这样]
```

### 6. 内化到knowledge.md
```
### 2025-10-08 [@work_with_expert:claude]
**任务**: {任务描述}

**我的弱点**:
- [弱点1及根因]
- [弱点2及根因]
- [弱点3及根因]

**Claude的优势**:
- [优势1及原理]
- [优势2及原理]

**改进原则**:
- [针对弱点1的改进]
- [针对弱点2的改进]

**下次执行此类任务时**:
- 避免：[我的错误模式]
- 采用：[Claude的正确模式]
```

### 7. 报告结果
```
✅ 已与Claude专家对比学习
📊 任务结果：
  - 我的尝试：[具体结果]
  - Claude的结果：[具体结果]
🔍 发现弱点：[具体弱点列表]
📝 知识更新：已写入knowledge.md
🎯 下次改进：[具体改进计划]
```

---

## 学习的本质

### 错误的学习方式
```
看Claude做 → "哦，原来这样" → 结束
（没有暴露自己的问题）
```

### 正确的学习方式
```
自己先做 → 暴露问题 → 看Claude怎么做 → 对比发现差距 → 理解根因 → 内化改进
（通过对比发现具体弱点）
```

---

## 示例：修复测试任务

### 用户指定
```
@work_with_expert "修复customer-service的13个失败测试"
```

### 执行流程

**步骤1：自己先做**
```
执行30轮，修好5个，还剩8个
使用了tail -10，陷入了局部优化
```

**步骤2：记录自己的过程**
```
my_attempt_summary.md:
- 策略：逐个修改验证规则
- 工具：mvn test | tail -10
- 结果：5/13修好
- 卡点：一直在改验证，不知道为什么还失败
```

**步骤3-4：Claude执行**
```
Claude执行同样任务
结果：13/13全部修好，用了15轮
```

**步骤5：对比分析**
```
差异1：信息收集
- 我：tail -10（丢失90%信息）
- Claude：tee保存完整输出
- 弱点：我过于追求简洁，丢失关键信息

差异2：问题诊断
- 我：看到错误就改代码
- Claude：先读测试理解意图，再改代码
- 弱点：我缺少"理解"步骤

差异3：修复策略
- 我：批量修改验证规则
- Claude：一次修一个，立即验证
- 弱点：我的反馈循环太长
```

**步骤6：发现弱点**
```
弱点1：信息不完整（tail -10）
弱点2：缺少理解步骤（直接改代码）
弱点3：反馈循环长（批量修改）
```

**步骤7：内化**
```markdown
### 2025-10-08 [@work_with_expert:claude]
**任务**: 修复测试

**我的弱点**:
- 使用tail -10丢失信息
- 跳过理解直接改代码
- 批量修改无法定位问题

**改进原则**:
- 用tee保存完整输出
- 理解测试意图再修改
- 一次改一个立即验证

**下次**:
第一步：tee保存完整输出
第二步：读测试代码理解意图
第三步：一个一个修
```

**步骤8：报告**
```
✅ 已对比学习
我的结果：5/13修好
Claude的结果：13/13全修好
发现弱点：信息不完整、缺少理解、反馈循环长
已内化改进
```

---

## 关键洞察

**学习 = 发现弱点 + 针对性改进**

只有自己先做，才能暴露真实弱点
只有对比，才能发现具体差距
只有理解差距根因，才能真正提升

**先做 → 失败 → 对比 → 发现弱点 → 改进**

这才是真正的学习！

