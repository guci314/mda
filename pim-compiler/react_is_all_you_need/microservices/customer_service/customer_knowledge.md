# 客户服务知识库

## 服务职责
客户服务负责管理客户信息、会员等级、优惠政策等。

## 自然语言函数

### 函数：获取客户信息
```
接收客户ID，
从 /tmp/microservices/customers/customers.json 读取客户数据，
返回客户详细信息包括：
- 客户ID
- 姓名
- 电话
- 地址
- 会员等级（VIP/普通会员/非会员）
- 注册时间
- 累计消费
```

### 函数：获取客户折扣
```
接收客户ID，
查询客户会员等级，
根据等级返回折扣率：
- VIP：8折（0.8）
- 普通会员：9折（0.9）
- 非会员：无折扣（1.0）
还要考虑特殊优惠券。
```

### 函数：注册新客户
```
接收客户信息（姓名、电话、地址），
生成客户ID（格式：CUST+序号），
初始化会员等级为"非会员"，
保存到客户数据文件，
返回新客户ID。
```

### 函数：更新会员等级
```
接收客户ID和新等级，
验证等级合法性（VIP/普通会员/非会员），
更新客户数据，
记录等级变更历史到 /tmp/microservices/customers/level_history.json，
返回更新结果。
```

### 函数：查询客户订单历史
```
接收客户ID，
从订单服务获取该客户的所有订单，
统计累计消费金额，
返回订单历史摘要。
```

### 函数：发放优惠券
```
接收客户ID和优惠券信息，
保存优惠券到 /tmp/microservices/customers/coupons.json，
设置优惠券状态为"未使用"，
返回优惠券编号。
```

## 与其他服务的协作

### 响应订单服务请求
```
当收到订单服务的客户信息请求时：
1. 解析客户ID
2. 调用 获取客户信息 函数
3. 调用 获取客户折扣 函数
4. 返回客户信息和折扣给订单服务
```

### 主动更新会员等级
```
当客户累计消费达到阈值时：
- 累计消费满5000元：升级为普通会员
- 累计消费满20000元：升级为VIP
自动调用 更新会员等级 函数。
```

## 数据存储位置
- 客户数据：`/tmp/microservices/customers/customers.json`
- 等级历史：`/tmp/microservices/customers/level_history.json`
- 优惠券数据：`/tmp/microservices/customers/coupons.json`

## 客户数据格式
```json
{
  "CUST001": {
    "name": "张三",
    "phone": "13800138000",
    "address": "北京市朝阳区xxx",
    "level": "VIP",
    "registered_at": "2023-01-01",
    "total_spent": 25000,
    "points": 2500
  }
}
```

## 会员权益
| 等级 | 折扣 | 积分倍率 | 其他权益 |
|------|------|----------|----------|
| VIP | 8折 | 2倍 | 免运费、优先发货、专属客服 |
| 普通会员 | 9折 | 1.5倍 | 满99免运费 |
| 非会员 | 无 | 1倍 | 无 |

## 业务规则
1. 客户电话必须唯一
2. 会员等级只能升级不能降级（除非特殊情况）
3. 优惠券有有效期限制
4. 积分可以兑换优惠券
5. VIP客户享受所有最优惠待遇